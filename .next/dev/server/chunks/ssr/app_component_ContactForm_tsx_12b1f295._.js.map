{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/wamp64/www/getsettime-landing-live/getsettime-landing/app/component/ContactForm.tsx"],"sourcesContent":["\"use client\";\r\nimport { useState, useEffect } from \"react\";\r\n\r\nasync function fetchDepartments(): Promise<{ list: string[]; error?: string }> {\r\n  try {\r\n    const res = await fetch(\"/api/departments\");\r\n    const data = await res.json();\r\n    if (!res.ok) return { list: [], error: data.error || \"Failed to load departments\" };\r\n    const list = Array.isArray(data.departments) ? data.departments : [];\r\n    return { list };\r\n  } catch (e) {\r\n    return { list: [], error: \"Network error loading departments\" };\r\n  }\r\n}\r\n\r\ntype FormData = {\r\n  name: string;\r\n  email: string;\r\n  phone: string;\r\n  department: string;\r\n  message: string;\r\n};\r\n\r\nconst ContactForm = () => {\r\n\r\n  const [formData, setFormData] = useState<FormData>({\r\n    name: \"\",\r\n    email: \"\",\r\n    phone: \"\",\r\n    department: \"\",\r\n    message: \"\",\r\n  });\r\n\r\n  const [status, setStatus] = useState<\"\" | \"sending\" | \"success\" | \"error\">(\"\");\r\n  const [errorMessage, setErrorMessage] = useState<string>(\"\");\r\n  const [departments, setDepartments] = useState<string[]>([]);\r\n  const [departmentsLoading, setDepartmentsLoading] = useState(true);\r\n  const [departmentsError, setDepartmentsError] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    let cancelled = false;\r\n    fetchDepartments()\r\n      .then(({ list, error }) => {\r\n        if (!cancelled) {\r\n          setDepartments(list);\r\n          setDepartmentsError(error ?? null);\r\n        }\r\n      })\r\n      .catch(() => {\r\n        if (!cancelled) {\r\n          setDepartments([]);\r\n          setDepartmentsError(\"Failed to load departments\");\r\n        }\r\n      })\r\n      .finally(() => {\r\n        if (!cancelled) setDepartmentsLoading(false);\r\n      });\r\n    return () => { cancelled = true; };\r\n  }, []);\r\n\r\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement>) => {\r\n    const { name, value } = e.target;\r\n    setFormData((prev) => ({ ...prev, [name]: value }));\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n\r\n    if (!formData.name || !formData.email || !formData.phone || !formData.department || !formData.message) {\r\n      setStatus(\"error\");\r\n      setErrorMessage(\"Please fill all required fields.\");\r\n      return;\r\n    }\r\n    console.log(formData);\r\n    try {\r\n      setStatus(\"sending\");\r\n      setErrorMessage(\"\");\r\n\r\n      const res = await fetch(\"/api/send-email\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify(formData),\r\n      });\r\n\r\n      // Clone the response before consuming it\r\n      const resClone = res.clone();\r\n\r\n      if (!res.ok) {\r\n        let errorMsg = `Error ${res.status}`;\r\n\r\n        try {\r\n          const errData = await res.json();\r\n          errorMsg = errData.error || errorMsg;\r\n        } catch {\r\n          // Use clone safely for text fallback\r\n          const text = await resClone.text();\r\n          errorMsg = text || errorMsg;\r\n        }\r\n\r\n        throw new Error(errorMsg);\r\n      }\r\n\r\n      const data = await res.json();\r\n\r\n      if (data.success) {\r\n        setStatus(\"success\");\r\n        setErrorMessage(\"\");\r\n        // Clear form fields after successful submission\r\n        setFormData({\r\n          name: \"\",\r\n          email: \"\",\r\n          phone: \"\",\r\n          department: \"\",\r\n          message: \"\",\r\n        });\r\n      } else {\r\n        setStatus(\"error\");\r\n        setErrorMessage(data.error || \"Failed to send email.\");\r\n      }\r\n\r\n    } catch (err) {\r\n      console.error(\"Submission error:\", err);\r\n      setStatus(\"error\");\r\n      const error = err as Error;\r\n      setErrorMessage(error.message || \"Network error. Please try again.\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n    <form onSubmit={handleSubmit} className=\"space-y-4\" aria-live=\"polite\">\r\n      <input id=\"name\" name=\"name\" type=\"text\" required placeholder=\"Full Name\" value={formData.name} onChange={handleChange} className=\"block w-full rounded-xl border border-slate-200/80 bg-white/80 px-4 py-3 placeholder-gray-600 focus:outline-none focus:ring-2 focus:ring-indigo-600\"/>\r\n      <div className=\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-2 gap-3\">\r\n        <input id=\"phone\" name=\"phone\" type=\"tel\" required inputMode=\"tel\" placeholder=\"Phone\" value={formData.phone} onChange={handleChange} className=\"block w-full rounded-xl border border-slate-200/80 bg-white/80 px-4 py-3 placeholder-gray-600 focus:outline-none focus:ring-2 focus:ring-indigo-600\"/>\r\n        <input id=\"email\" name=\"email\" type=\"email\" required placeholder=\"Email\" value={formData.email} onChange={handleChange} className=\"block w-full rounded-xl border border-slate-200/80 bg-white/80 px-4 py-3 placeholder-gray-600 focus:outline-none focus:ring-2 focus:ring-indigo-600\"/>\r\n      </div>\r\n      <div className=\"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-1 gap-3\">\r\n        <select id=\"department\" aria-label=\"Select Department\" name=\"department\" required value={formData.department} onChange={handleChange} disabled={departmentsLoading} className=\"block w-full text-gray-600 rounded-xl border border-slate-200/80 bg-white/80 px-4 py-3 focus:outline-none focus:ring-2 focus:ring-indigo-500 disabled:opacity-70\">\r\n          <option value=\"\">{departmentsLoading ? \"Loading departments…\" : \"Select Department\"}</option>\r\n          {departments.map((dept) => (\r\n            <option key={dept} value={dept}>{dept}</option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n      <textarea id=\"message\" name=\"message\" rows={4} required placeholder=\"How can we help?\" value={formData.message} onChange={handleChange} className=\"block w-full rounded-xl border border-slate-200/80 bg-white/80 px-4 py-3 placeholder-gray-600 focus:outline-none focus:ring-2 focus:ring-indigo-600\"/>\r\n      <div className=\"block sm:flex items-center justify-between items-center justify-between gap-3\">\r\n        <button type=\"submit\" disabled={status === \"sending\"} className=\"inline-flex items-center gap-2 bg-gradient-to-br from-indigo-800 to-indigo-500 text-white px-6 py-3 rounded-md font-medium shadow-lg hover:bg-indigo-800 transition-transform transform\" aria-disabled={status === \"sending\"}>\r\n          {status === \"sending\" ? \"Sending…\" : \"Send Message\"}\r\n        </button>\r\n      </div>\r\n      {status === \"success\" && (\r\n        <div className=\"mt-2 p-3 rounded-md bg-green-50 border border-green-200 text-sm text-green-700\">\r\n          ✓ Email sent successfully! We&apos;ll get back to you shortly.\r\n        </div>\r\n      )}\r\n      {status === \"error\" && (\r\n        <div className=\"mt-2 p-3 rounded-md bg-red-50 border border-red-200 text-sm text-red-700\">\r\n          ✗ {errorMessage || \"Oops — something went wrong. Please try again or contact us directly.\"}\r\n        </div>\r\n      )}\r\n    </form>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default ContactForm;"],"names":[],"mappings":"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"}}]
}